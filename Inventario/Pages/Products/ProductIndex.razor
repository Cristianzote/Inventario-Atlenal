@page "/product"
@inject NavigationManager navigationManager


<!--//Json imports-->
@using System.Text.Json;
@using System.Text.Json.Serialization;
@using System.Net.Http;
@using System.Net.Http.Json;
@using Inventario.Pages.Products;

<div class="sticky top-0 z-10 pt-2 pb-1 bg-green-800">
    <div class="flex justify-around mb-2">
        <input class="w-2/5 py-2 px-3 bg-green-500 text-green-900 placeholder-green-900 border border-green-900 rounded-md focus:outline-none focus:ring focus:ring-green-900"
            type="search"
            placeholder="Buscar productos..." />
        <select id="category" name="category" class="w-2/5 py-2 px-3 bg-green-500 text-green-900 border border-green-900 rounded-md focus:outline-none focus:ring focus:ring-green-900">
            <option value="todos">Todos</option>
            <option value="gaseosa">Gaseosa</option>
            <option value="bebidas">Bebidas</option>
            <option value="alcohol">Alcohol</option>
            <option value="medicina">Medicina</option>
            <option value="otros">Otros</option>
        </select>
    </div>
</div>

<!-- PRODUCTOS -->
<section class="grid grid-cols-3 md:grid-cols-5 lg:grid-cols-6 xl:grid-cols-7 gap-4 p-4 md:p-6">

    @for(int i = 0; i < 15; i++)
    {
        int aux = i;

        <div @onclick="() => modal.Toogle([aux.ToString()])" class="cursor-pointer bg-white rounded-lg shadow-md overflow-hidden">
            <img src="https://cdn-icons-png.freepik.com/512/803/803728.png"
                    alt="Product Image"
                    width="180"
                    height="180"
                    class="w-full object-cover aspect-square"
                    style="aspect-ratio: 1 / 1; object-fit: cover;" />
            <div class="p-4">
                <h3 class="font-semibold text-sm md:text-base text-center">Ron viejo de Caldas</h3>
                <p class="font-medium text-sm md:text-base text-slate-600 text-center">Alcochol</p>
            </div>
        </div>

        <div @onclick="() => modal.Toogle([aux.ToString()])" class="cursor-pointer bg-white rounded-lg shadow-md overflow-hidden">
            <img src="https://cdn-icons-png.freepik.com/512/803/803728.png"
                    alt="Product Image"
                    width="180"
                    height="180"
                    class="w-full object-cover aspect-square"
                    style="aspect-ratio: 1 / 1; object-fit: cover;" />
            <div class="p-4">
                <h3 class="font-semibold text-sm md:text-base text-center">Aguardiente antioqueño</h3>
                <p class="font-medium text-sm md:text-base text-slate-600 text-center">Alcochol</p>
            </div>
        </div>

        <div @onclick="() => modal.Toogle([aux.ToString()])" class="cursor-pointer bg-white rounded-lg shadow-md overflow-hidden">
            <img src="https://cdn-icons-png.freepik.com/512/803/803728.png"
                    alt="Product Image"
                    width="180"
                    height="180"
                    class="w-full object-cover aspect-square"
                    style="aspect-ratio: 1 / 1; object-fit: cover;" />
            <div class="p-4">
                <h3 class="font-semibold text-sm md:text-base text-center">CocaCola</h3>
                <p class="font-medium text-sm md:text-base text-slate-600 text-center">Gaseosa</p>
            </div>
        </div>

        <div @onclick="() => modal.Toogle([aux.ToString()])" class="cursor-pointer bg-white rounded-lg shadow-md overflow-hidden">
            <img src="https://cdn-icons-png.freepik.com/512/803/803728.png"
                    alt="Product Image"
                    width="180"
                    height="180"
                    class="w-full object-cover aspect-square"
                    style="aspect-ratio: 1 / 1; object-fit: cover;" />
            <div class="p-4">
                <h3 class="font-semibold text-sm md:text-base text-center">Tinto</h3>
                <p class="font-medium text-sm md:text-base text-slate-600 text-center">Bebida</p>
            </div>
        </div>
    }
    
</section>

<div class="fixed bottom-24 right-4">
    <button class="bg-green-800 text-white rounded-full p-4 shadow-md hover:bg-green-900 hover:text-white focus:outline-none focus:ring-2 focus:ring-green-00 focus:ring-opacity-50 flex items-center">
        <a href="/product/create" class="flex items-center">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
            </svg>

            <h1>  Añadir producto</h1>
        </a>
    </button>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

<CheckProductModal @ref=modal />

@code {

    //CheckProductModal modal;

    private JsonElement userData;
    protected override async Task OnInitializedAsync()
    {
        try
        {
            /*Console.WriteLine("Holi");
            using (var httpClient = new HttpClient())
            {
                var response = await httpClient.GetAsync("http://localhost:5175/api/v1/product");
                if (response.IsSuccessStatusCode)
                {
                    var jsonString = await response.Content.ReadAsStringAsync();
                    Console.WriteLine(jsonString);
                }
            }*/


            HttpClient cliente = new HttpClient();

            cliente.BaseAddress = new Uri("http://api.inventory.linapps.co/");


            var response = cliente.GetAsync($"http://localhost:5175/api/v1/product");

            //var body = await response.Content.ReadAsStringAsync();
        }
        catch(Exception ex)
        {
            Console.WriteLine(ex);
        }
    }


    //public List<SProduct>? Products { get; set; }


    //public string Products = "a";

    //Products = await repository.Get<List<Product>>("https://pokeapi.co/api/v2/pokemon/ditto").Response!;

}
